# 开发流程：
- 固定按钮权限，最后设置对应的显示进入权限（1day）
- 优先设置页面样式，前期优先不设置对应的真实图片，然后展示对应的列表展示（2day，主要是对应的样式设置）
- 添加对应的新增模版按钮，对应的系统模版和自定义模版后期设置
- 点击点击新增按钮，进入对应的模版创建和模版编辑界面，主要是设置对应的页面样式，文本设置成为富文本编辑器，设置一个对应的附件按钮，然后设置出上传附件的功能，有对应的上传成功的提示文本（3day）
- 模版设置页面，新增群组功能（2day）
- 最后收尾，权限设置，生成真实图片（2day）
**历史记录/类似/总结** 
*系统模版样式不同，模版列表的淡入淡出效果，系统模版的展示文本*


# 具体开发细节：
  ## 页面样式细节：
   - 侧边功能按钮样式：与总结相同
   - 模版初始页样式：系统默认样式与总结不同，三类系统模版，一个自定义模版, 
    - 四类基础样式：对应的背景颜色不同，都有淡入淡出效果，显示对应的功能按钮和删除
   - 模版新增/编辑页面样式：
    - 左侧组件列表，与总结类似
    - 中间展示部分，样式相似，功能不同，多出附件样式，参考编辑
      1. 标题有新增样式：
        鼠标滑过显示文本框，滑出文本框消失；
        字数限制，最大宽度，超过换行；
        删除文本内容显示默认提示文本；

    - 右侧设置部分，样式相似
   - 模版设置页面：
    - 整体样式相似与总结页面
   - 历史记录样式：与总结相同
  ## 页面功能细节：
    - 初始化页面真实预览图展示：在保存的时候生成一个真实图片上传后端，后端返回会对应的图片的链接地址，面谈中有对应的功能模块
    - 修改组件内容,支持修改标题,鼠标滑过效果不变，点击不仅需要真实右侧设置,同时还需要更改对应的组件类型
    - 文本替换成为富文本编辑器，借鉴之前的创建功能模块
    - 附件：前期先展示一个按钮样式，后期时间充裕实现文件上传功能,可以设置成为file元素,实现对应的元素选择上传（使用JS的file对象可以实现应该）
    - 模版设置：可见范围多了一个群组分类，后端有对应的借口，需要设置一个对应的按钮调用这个接口数据、


# 对接后端接口
  ## 模版初始页面：
  1. getUserRole获取用户当前对于模版的权限，不是获取用户的身份权限，1，2对应什么，还有什么权限
  2. getTemplateData 获取模版列表数据，获取到的数据的格式会转换成为对应的ISummaryTemplateListData接口类型，之后会在每个列表元素中对应调用两个接口changeDeactivate changeStartUp 这两个接口返回的数据未知
  3. 每个具体的元素有一个单独的组件-templateList，会根据父组件传递过来的userRole做对应的权限判断，确保内容显示的正确性
    即如果有对应的新增权限，就会显示对应的新增模版的功能按钮
  4. 每个列表项都有一个card组件，用来实现对应的样式和对应的操作
  5. 点击新增复盘，会显示对应的四个类型，每个都有单独对应的value值，需要和后端进行协商
      同时，新增的每类模版都有一个初始样式，需要看之前的业务逻辑，是前端固定写死，还是后端返回初始模版
      新增弹窗，点击确定之后会调用 /summaryTemplate/modules 接口，因为点击确定会导致地址栏发生改变
      地址栏发生改变会触发创建模版组件中的一个监听，这个监听会调用这个接口获取对应的模块数组

      这个接口会对应返回一个 modules 数组
      
  6. 创建模版弹窗 submit 事件会调用window.open方法，前往对应的模版创建页面 此处没有涉及和后端的交互，只是单纯的路由跳转
  7. 模版编辑页面，上面有tab选项卡进行对应的切换，在模版编辑和模版设置两个页面之间进行切换
    模版编辑页面采用三列布局：左侧选项；中间内容；右边设置
    模版设置页面采用 
    最后🙆统一在一个确认按钮处调用后端接口发送数据
  8. 在对应的创建模版的页面的顶部有保存/保存并启用两个按钮
    两个按钮都会对应触发一个方法，向后端发送对应的数据，区别仅在于启用的参数不同
    之后都会发送对应的参数，此处的参数需要和后端进行对应的协商，确保数据的正确
    但是此处的问题是还需要发送一个对应的数据来保存对应的封面图片
    此处的feedId主要是做什么作用
    用户权限数据在哪里发送——EnbleScope，是一个对象，对象内部的三类key对应三类权限


    创建页面整体的实现逻辑：
      首先前端维护了一套组件数组，总共分为四种情况，根据是否是菜单和是否是系统自建进行区分
      惯常的操作逻辑是需要区分用户操作：
        首先是区分编辑和新增操作
        之后是区分自定义模版和系统模版
        这样会按理说会产生四种情况：编辑自定义，新增自定义，编辑系统，新增系统（不存在这种情况）
        所以就产生了三种情况：
          系统：编辑
          自定义：编辑；新增
          所以对应的第一层判断条件成为了对于是否是系统模版的判断
          第二层判断条件成为了是否是新增模版的判断
            最后一种情况（编辑自定义模版）会调用对应的后端接口，需要获取该模版之前的详细信息
            在展示之前都需要做一个对应的权限验证，
            code = 1 设置成为没有权限，同时如果没有对应的data数据，就展示对应的友好页面提示没有权限
      - 上述三种情况有置换id的操作，我没有很理解，其他还是可以的


问题记录：
  1. 侧边菜单按钮多语言设置出错，暂时使用中文顶替
  2. 创建模版按钮多语言文本设置失败，暂时使用中文顶替
  3. 模版列表项标题过长会有文本提示，但是此处不需要，所以需要修改Tooltip的鼠标移入的响应函数，做对应的判断，但是没有再Tooltip中找到
    此处使用span替代Tooltip进行暂时顶替
  4. list组件中的data向下传递到了对应的列表项中，但是list中的data是从后端获取的，这个时候的数据是之前总结中的数据，所以是有问题的 
    目前我想到的解决方法就是添加一个字端进行区分，复盘默认添加，总结默认不加
  5. 每一个穿到card的data中都有一个summaryTemplateModules，内部是当前模版的组件在默认加上附件和@，
    所以需要找到默认添加的地方，应该是在保存的时候会进行针对这个进行操作
    所以应该修改调用保存接口的方法
    同时还应该修改左侧菜单和中间的附件的展示
  6. 系统模版模版是在card中进行的样式修改，是通过class进行的样式修改
      所以应该查找到之前的代码在哪里设置的class，之后在添加新的class，
      然后进行对应的样式修改，
      同时还需要修改对应的模版头像，头像是固定的
      现在找到了是在content中添加对应的playDailyType和class之间的对应关系，
      但是不知道有哪几类playDailyType，所以也不能单纯的设置class
      所以需要和后端协商playDailyType
      现在先暂时试一下对应的class和样式
      需求变更：
        之前的背景颜色设置在头部，现在需要更改到内容区
        也就是需要将之前在头部的一套逻辑转移到内容区


# 接口汇总： 
  1. 初始化页面调用两个接口
    list /summaryTemplate/list   GET方式，不需要传参
    获取所有的模版，如果总结和复盘使用一套接口，就需要对应的在此处进行参数传递，进行区分
    
    userRole /summaryTemplate/userRole GET方式 不需要传参
    用户角色不需要区分，对应的权限需要进行确认，之后再决定是否需要传参确定类型


  2. 点击已有模版调用接口：
    templateDetial /summaryTemplate/detail?templateId=326 GET方式 拼接templateId
    ID唯一，不需要进行对应的区分，即使模版数据共同，也有对应的ID进行区分


  3. 点击模版设置，设置可见人员范围会调用一个接口两次
    /department/sub/depsAndUsers?departmentId=-1&isGetUser=true&isRoot=true&staffStatus=1
    GET方式 拼接很多ID，不知道干嘛的
    /department/sub/depsAndUsers?departmentId=-1&isGetUser=true&staffStatus=1
    同上
    这两次传递的参数不同
    点击下属会调用另一个接口
    /org/subordinate?to_userId=500017302 GET方式 拼接userId
    不可见人员和可见人员调用接口情况相同
    模版管理员只会调用一个下属接口
    /org/subordinate?to_userId=500017302

    上述人员接口完全可以通用


  3. 已有模版更改之后点击保存按钮调用一个接口
    save /summaryTemplate/save POST方式
      JSON形式传递参数：  
      对应也会传递templeID，所以可以进行唯一标识


  4. 点击保存之后，延时重新跳转会重新调用一遍初始化时候调用的接口
      但是会多调用几个接口
      /summary/getShareUsers?toUserId=500017302 GET方式 拼接toUserId（这个参数是干嘛的） 重新设置可见范围
      /user/getRelationUsers?relationIds=3&toUserId=500017302 GET方式 拼接relationIds=3&toUserId=500017302 这个接口的作用
      然后重新调用 userRole 和 list


  5. 新建调用一个接口
      modules  /summaryTemplate/modules  GET方式 不需要传递参数

      点击保存并启用同样调用一个save接口
      保存同样调用save接口


# 样式问题：
  1. 部分内容块底部不显示圆角  ✅    在每个单独的模版类型样式（OKR）中也设置了对应的圆角
  2. 未启用的模版样式设置不生效  ✅   缺少一个类名添加 未启用
  3. 顶部样式：
    头像宽度 24px  + 6px + 105px + 4px + 提示（52px-未启用 40px-系统）
  4. 图标样式问题
    图标字体库
    转换成为了路径问题
    路径字符串不能使用拼串吗？
    需要引入对应的图片，但是图片路径会在对应的函数处理之前被读取

    解决方式：
      使用require引入图片
      但是需要设置对应的变量区分路径
      写法：字符串拼串
      定义路径，使用
    ✅    直接使用图标字体库
  5. 后端返回的数据不对，之后善良，先搭出架子，暂且搁置
  6. 列表项展示的数据不对，应该展示真实数据
      后续处理，暂且搁置

# 10.19进度：
    完成首页基础显示，
    但是首页数据有问题
      1. 模版是总结中的模版
      2. 首页显示的是默认数据不是真实数据

# 多语言


10.20:
# 新增弹窗：

    
# 新增页面：
  1. 左侧需要添加一个附件选项
    之前的解决方案：
      有四个对应的模版数组，分别通过是否是系统模版，是否是菜单进行区分
    ✅ 
    修改了constant内部预设的内容
    但是不知道具体的moduleRules配置项的作用
  ## 对于中间内容块的设置
    中间的具体内容块是有后端进行控制的
    所有的已有的模版在后端都会存储了一个对应的数组
    点击已有的模版进入对应的新增页面
    会调用
     detail?templateId=326
    接口，GET方式，拼接当前的模版id
    接口返回的数据中 summaryTemplateModules 字段是一个对象数组，记录了当前的模版的组件信息（）
    之后使用filter方法
          // 从返回的数据中获取对应的summaryTemplateModules
          // 数据分析：red是当前模版页面的详细信息，res.data.summaryTemplateModules是当前模版页面的组件数组
          // 用这个组件数组与前端设定的组件列表进行匹配，如果是前端组件列表中存在的组件，就放到modules中，那么最后modules中就是当时已经预设好的组件数据
          // 因为不是所有的数据都是当前页面需要的，比如，心情组件，在复盘中就不需要，所以此处做了删除，因为在前端预设的组件数组中已经删除了对应心情组件，所以此处并不会讲心情组件加入modules中

  3. 每个组件的标题支持修改，然后就需要获取对应修改之后的标题，对应的生成数据，传递给后端，
  

  5. 删除心情组件  ✅  直接注释掉了Template中的心情组件
  6. 需要找到中间显示部分渲染的地方，
      新增组件入口设置了对应的标题显示，
      但是之前已有模版的标题展示没有找到对应的位置，即应该有一个兼容，就是有标题的情况下展示已有的标题，没有的情况下展示默认标题
      但是没有找见，显示的是后端返回的标题
      首先需要找到对应的显示的位置
    之后，
      新增页面多了两个组件，
      且系统模版不显示后面两个，项目也没有正常显示

  10. 新添加的模版不能正常的显示附件组件，但是文本组件可以正常显示
      优先查看发送给后端的数据是否有问题
      然后查看后端返回的数据是否有问题
      保存时候发送给后端的数据没有问题
      点击进入时，后端返回的数据也没有问题，此时应该查找具体的显示逻辑，应该还是constant中的设置项出了问题
      且此时，后端会对应多返回一个附件组件（应该是前端上传数据的时候，默认会添加一个附件组件），所以应该找到对应的添加的位置，将多余添加的附件删除掉


  7. 找到对应的显示文本，更改对应的显示文本  
    只有在新增模版中可以解决，已有的模版数据不能解决，因为已有的模版数据属于总计的模版
    二者并不通用，所以并不能进行统一处理
    暂时看起来是已经解决了  ✅

  9. 支持修改对应的组件标题
    解决思路：
      找到右侧配置项的实现方式，然后在对应的标题上进行对应的解决
      面临的一个问题是如何在鼠标滑过时，让元素显示成为文本框

  9. 发web-v4新版 晚上六点左右  必然能够解决，✅
# 模版设置页面：
  1. 可见范围，人员分组情况不同，似乎主要就是这一个问题

目前需要解决的问题：
  - 查看在哪里设置的附件不显示  ✅  但是修复之后，就只能添加一个附件组件了，添加了一个之后，就会对应显示附件组件不可选
  - 在哪里多余添加的一个附件  找不见
    可能会在两个地方多出来
    一个是向后端发送时 注意查看save中的数据就可以了
    一个是前端拿到渲染时
  - 修改组件标题
  - 修改模版标题
  - 添加对应的数据结构的文件
  - 添加系统模版
  - 给后端的数据中多余一个字段

  10.21:
    主要完成三个功能：
      中间部分多加的一个附件块，需要找到并删除，
      并且发送给后端的文本块的id不对，需要找到设置id的位置，并修改
      右边的设置选中顺序和样式不对，需要进行调整
      如果可以，尽量修改一下对应的人员的部分的样式，现在上传给后端的数据中已经添加了群组，但是用户还不能选择群组
      还要对于表格写出三条假数据进行后续的操作
  1. 附件：
      对已有模版编辑并保存时，如果是没有附件组件，会接口报错，新建则不会   正在协商
          已经调用了save接口，但是后端返回的code码不对，所以是后端对他做了什么处理
          假设后端做了处理
      添加的的附件ID不对,时对时不对  正在协商
        已有模版新增附件，id是annex
        编辑已有模版，新增附件组件，发送的数据中ID不对，但是新增模版不需要附件组件
        获取详情在某一处已经做了id的转换
      发送给后端的文本ID不对   ✅
        新增模版不需要添加ID
        编辑已有模版文本对应的ID出现异常   ✅  之前的默认处理方式，新建的会传moduleId，不是新建的会传Id，但是因为文本组件不唯一，所以不会用唯一ID进行标识
      重新渲染多余一个附件，调用detail？template接口时返回的数据会多一个  ✅   已经解决，后端处理
        假设后端多添加了
      
  2. 右侧设置块；
      导入的默认选中不对   
      样式设置不对

  3. 表格组件的默认数据，三条
  4. 系统默认模版的生成
  5. 左侧设置块
      设置的是一个对应的枚举类型，
      如何根据枚举类型后面的数字获取到前面的内容
  6. 保存发送的数据多一个字段
      字段会在modules接口中返回，
      会在新建的时候，编辑的时候都会调用，都会从这个接口中获取对应的数据，
      那也就是说只要在对应的位置上设置这个数据，就能够进行对应的获取
  
  7. 中间块设置：
    文本设置成为富文本编辑器
    支持鼠标点击修改标题，鼠标移入显示文本框

  项目 6 任务 3 附件 4  OKr 2 文本 0




# 大问题：
  4. 需要和丁哥解决后期的表格替换问题
    之前的模版中没有这个设置，
    所以，此处选择直接引入
    但是需要默认数据
    默认数据需要看对应的组件规定的数据结构和后端返回的具体的数据值

  8. 然后替换文本组件成为富文本编辑器
  ```javascript
  import RichEditor, {
  EditorComponent,
  EditorToolbar,
  TitaRichEditorMethods,
} from '@titaui/rich-editor';
  ```

  ToolTip组件 是 提示

  2. 中间的文本选项需要设置成为富文本编辑器

  1. 需要设置对应的四个选项，每个选项对应一个value值，但是这个value值是干嘛的
    自己手动添加的value中成为了type值之后，需要和新增页面的模版数组匹配，生成对应的初始化模版
    需要设置的内容是四个选项的样式

  11. 生成真实图片用于展示
    解决思路：
      需要参考一对一面谈的解决思路

  

问题：
  1. 默认附件和@查看，现在更改为默认@查看，没有附件，附件根据前端发送的数据添加
  2. 编辑已有模版如果不添加附件组件，会返回500报错，参数格式和其余的一样，出错原因
  3. 编辑添加附件时，id出错，传递的id是annex，后端需要什么格式的ID

# 10.23 
  将文本区域换成富文本编辑器
  实现标题的双向数据绑定
    但是现在出现的问题就是 
    设置一个state，调用set方法，就会将所有的组件设置为统一的state
    如果设置四个state
    或者设置一个变量moduleName作为区分，也不太行，毕竟只能有一个，所以赋值也只能赋值一个
    现在想到的就是设置四个state或者在一个state中设置四个变量
    但是这个不能实现，所以还是需要设置四个或者五2state


  # 10.25
    两个组件的引入
    选人组件的修改
    真实预览图的生成
      两个部分：
        生成真实图片

        设置真实图片


# 尚存问题
  1. 权限问题，创建按钮根据权限显示
  2. 创建弹窗的样式和默认选中
  3. 系统模版功能
  4. 创建弹窗的默认选中
  5. 初始化模版的默认组件
  6. 组件下面的添加按钮入口 OKR周期添加按钮存在
  7. 侧边设置进展，只能查看，不能更改
  8. 富文本删除任务 ✅
  9. 附件设置 单独设置一个组件，不能套用之前的
  10. 空组件保存 ✅  
  11. 输入框的hover事件
  12. 标题的默认提示文本
  13. 真实预览图
  14. 表格动态插入列
  
  feed





1. forwardRef


后续可能存在的问题：  
  空格命名问题，


  


多语言问题：
  该复盘模板将被删除不可恢复，请谨慎操作
  该复盘模板已启用，删除后相关人员将不可使用，请谨慎操作
  确定删除复盘模版吗？


		moduleCode: "reviewText",
		moduleCode: "reviewWork",
		moduleCode: "reviewTask",
		moduleCode: "reviewOKR"	,
		moduleCode: "reviewDoc",



1、附件组件为必填    ✅
2、点击进入模板编辑页面 白页    ✅
3、拖动OKR、项目\任务组件 内容错乱                    ✅
4、模板文本组件屏蔽@人功能                           ✅   
6、组件自定义提示语，进入模板编辑页面，提示语乱码         ✅
7、模板中项目可以打开详情页                           ✅
8、点击项目打开详情页，在点击任务、OKR、文本组件，页面卡死 ✅
9、系统模板排序                                     ✅
10、模板列表应该自适应页面                            ✅
11、创建模板弹窗，选择项样式                          ✅
12、项目、任务组件， 负责人列没展示    ✅


single-common
  motion = 1,
	rich = 0,
	okr = 2,
  task = 3,
  project = 6,
	annnex = 4



样式问题:
  未启用的显示问题
  

